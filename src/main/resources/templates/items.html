<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <title>–í–∏—Ç—Ä–∏–Ω–∞ –º–∞–≥–∞–∑–∏–Ω–∞</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
          crossorigin="anonymous"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
          rel="stylesheet"/>
    <link th:href="@{/css/styles_items.css}" rel="stylesheet">
    <link th:href="@{/css/styles_btn.css}" rel="stylesheet">
    <link th:href="@{/css/styles_zoom.css}" rel="stylesheet">
</head>

<body class="bg-light">

<form id="main"></form>

<div class="container p-2">
    <div class="row p-2">
        <div class="col">
            <div class="hstack gap-3">
                <h2>
                    <span class="badge text-bg-success">–í–∏—Ç—Ä–∏–Ω–∞ –º–∞–≥–∞–∑–∏–Ω–∞</span>
                </h2>
                <a th:href="${ordersAction}" class="btn btn-secondary ms-auto bi bi-file-earmark-text"> –ó–∞–∫–∞–∑—ã</a>
                <a th:href="${itemsToCartAction}"
                   class="btn btn-secondary bi bi-cart4 position-relative"> –ö–æ—Ä–∑–∏–Ω–∞
                    <span th:if="${totalItemsCounts > 0}"
                          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                          th:text="${totalItemsCounts}">
                    </span>
                </a>
            </div>
        </div>
    </div>

    <div class="row p-2">
        <div class="col">
            <div class="hstack gap-3">
                <input
                        class="form-control me-2 mw-100"
                        type="search"
                        placeholder="–ù–∞–π—Ç–∏..."
                        aria-label="–ü–æ–∏—Å–∫"
                        name="search"
                        th:value="${search}" form="main"
                />
                <button
                        class="btn btn-outline-success"
                        type="submit"
                        form="main">–ù–∞–π—Ç–∏
                </button>
                <div class="form-floating w-25">
                    <select
                            class="form-select"
                            id="sort"
                            name="sort"
                            onchange="document.getElementById('main').submit()"
                            form="main">
                        <option value="NO" th:selected="${sort=='NO'}">üîò –±–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
                        <option value="ALPHA_ASC" th:selected="${sort=='ALPHA_ASC'}">üî§ –ê-–Ø üîº</option>
                        <option value="ALPHA_DESC" th:selected="${sort=='ALPHA_DESC'}">üî§ –Ø-–ê üîΩ</option>
                        <option value="PRICE_ASC" th:selected="${sort=='PRICE_ASC'}">üí∞ —Ü–µ–Ω–∞ üîº</option>
                        <option value="PRICE_DESC" th:selected="${sort=='PRICE_DESC'}">üí∞ —Ü–µ–Ω–∞ üîΩ</option>
                    </select>
                    <label for="sort">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
                </div>
                <div class="form-floating w-25">
                    <select
                            class="form-select"
                            id="pageSize"
                            name="pageSize"
                            onchange="document.getElementById('main').submit()"
                            form="main">
                        <option value="2" th:selected="${paging.pageSize==2}">2</option>
                        <option value="5" th:selected="${paging.pageSize==5}">5</option>
                        <option value="10" th:selected="${paging.pageSize==10}">10</option>
                        <option value="20" th:selected="${paging.pageSize==20}">20</option>
                        <option value="50" th:selected="${paging.pageSize==50}">50</option>
                        <option value="100" th:selected="${paging.pageSize==100}">100</option>
                    </select>
                    <label for="pageSize">–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</label>
                </div>
            </div>
        </div>
    </div>

    <div class="row p-2">
        <div class="col">
            <div class="hstack gap-3 justify-content-left">
                <button type="submit" class="btn btn-light" th:if="${paging.hasPrevious}" name="pageNumber"
                        th:value="${paging.pageNumber-1}" form="main">‚óÄÔ∏è
                </button>
                <span th:text="${'–°—Ç—Ä–∞–Ω–∏—Ü–∞: '+paging.pageNumber+'/'+paging.totalPages}"></span>
                <button type="submit" class="btn btn-light" th:if="${paging.hasNext}" name="pageNumber"
                        th:value="${paging.pageNumber+1}" form="main">‚ñ∂Ô∏è
                </button>
            </div>
        </div>
    </div>

    <div class="row p-2" th:each="itemsRow : ${items}">
        <div class="col" th:each="item : ${itemsRow}">
            <div class="card my-items-product-card my-zoom" th:if="${item.id != -1}">
                <a th:href="${itemsAction+'/'+item.id}">
                    <img th:src="${item.imgPath}" class="card-img-top" alt="–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
                </a>
                <div class="card-body my-items-product-card-body">
                    <h5 class="card-title" th:text="${item.title}"></h5>
                    <h5>
                        <span class="badge text-bg-success justify-content-end"
                              th:text="${item.price}+' —Ä—É–±.'"></span>
                    </h5>
                    <p th:text="${item.description}"></p>
                    <form th:action="${itemsAction}" method="post" class="mt-auto w-100">
                        <div class="hstack gap-3 justify-content-between w-100">
                            <input type="hidden" name="id" th:value="${item.id}">
                            <input type="hidden" name="search" th:value="${search}">
                            <input type="hidden" name="sort" th:value="${sort}">
                            <input type="hidden" name="pageSize" th:value="${paging.pageSize}">
                            <input type="hidden" name="pageNumber" th:value="${paging.pageNumber}">

                            <!-- –ö–Ω–æ–ø–∫–∞ MINUS –∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ count > 0 -->
                            <button type="submit"
                                    class="badge text-bg-warning my-btn-circle"
                                    name="action"
                                    value="MINUS"
                                    th:disabled="${cartItems.getOrDefault(item.getId(), 0) <= 0}">‚àí
                            </button>

                            <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ -->
                            <span th:text="${cartItems.getOrDefault(item.getId(), 0)}"></span>

                            <!-- –ö–Ω–æ–ø–∫–∞ PLUS –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞ -->
                            <button type="submit"
                                    class="badge text-bg-success my-btn-circle"
                                    name="action"
                                    value="PLUS">+
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
        integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y"
        crossorigin="anonymous"></script>
<script th:src="@{/js/app.js}"></script>
</body>
</html>
